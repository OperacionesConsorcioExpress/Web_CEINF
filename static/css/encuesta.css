/* =========================================================
   TOKENS Y TEMAS
   ========================================================= */
:root{
  --blue-900:#25397A;
  --blue-800:#324A8E;
  --blue-700:#3F5DB2;
  --blue-600:#5076E2;
  --blue-400:#83A4FF;
  --blue-200:#BBCCF9;

  --green-700:#16A038;
  --green-600:#2BC14B;
  --green-500:#3EE561;

  --white:#FFFFFF;
  --black:#000000;

  --radius:16px;
  --shadow:0 10px 30px rgba(0,0,0,.12);
}

/* Tema claro */
:root,
:root[data-theme="light"]{
  --bg:#FFFFFF;
  --card:#F3F6FF;
  --ink:#0E1A3A;
  --ink-muted:#4F5E87;
  --primary:var(--blue-600);
  --primary-ink:var(--white);
  --border:rgba(37,57,122,.18);
  --shadow:0 10px 30px rgba(248, 246, 246, 0.838);
  --title-color:var(--blue-900);
}

/* Tema oscuro */
:root[data-theme="dark"]{
  --bg:linear-gradient(180deg, #34394898, #4c587d);
  --card:#636771;
  --ink:#EAF0FF;
  --ink-muted:#BBCCF9;
  --primary:var(--green-600);
  --primary-ink:var(--white);
  --border:rgba(187,204,249,.25);
  --shadow:0 10px 30px rgba(248, 246, 246, 0.377);
  --title-color:var(--blue-200);
}

/* =========================================================
   BASE
   ========================================================= */
*{ box-sizing:border-box; } /* Reset de box-sizing */
html,body{ height:100%; } /* Reset de altura */
html{ font-size:12px; } /* Tamaño base de fuente */

/* ─ Ajuste leve de márgenes generales para “correr a la izquierda”
     (menos margen/padding horizontal global) */
body.body{
  margin:4px;                 /* antes 10px */
  padding:4px;                /* antes 10px */
  background:var(--bg); color:var(--ink); /* fondo y color de texto */
  font:12px/1.00 "Century Gothic",system-ui,-apple-system,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
  overflow-x:hidden; /* Evitar scroll horizontal */
}

/* ─ Menos padding lateral para ganar ancho útil */
.survey-shell{
  min-height:100vh; /* antes 100% */
  display:flex; flex-direction:column; /* antes column-reverse */
  padding:0 26px;             /* antes 0 26px */
  width:100vw; max-width:97vw; /* antes 100% */
}

/* =========================================================
   HEADER
   ========================================================= */
.survey-header{
  display:inline-flex; align-items:flex-start; justify-content:space-between;
  gap:12px;                   /* antes 16px */
  margin-bottom:10px;         /* antes 12px */
}
.title{ margin:0; font-size:2rem; color:var(--title-color); }
.subtitle{ margin:0; color:var(--ink-muted); }
.brand-right{ display:flex; align-items:center; gap:10px; } /* antes 12px */

.brand-bar{
  display:flex; align-items:center; gap:10px; /* antes 12px */
  padding:6px 8px;              /* antes 8px 10px  -> más compacto */
  background:#FFFFFF;
  border:1px solid var(--border); border-radius:12px; box-shadow:var(--shadow);
}
:root[data-theme="dark"] .brand-bar{ background:#FFFFFF; }
.brand-logo{ height:34px; width:auto; display:block; } /* -2px cada logo */
.brand-logo.ce{ height:32px; }
.brand-logo.ci{ height:40px; }
.brand-logo.pbi{ height:36px; }
.divider{ width:1px; height:26px; background:var(--border); border-radius:2px; }

.btn-secondary{
  background:transparent; color:var(--ink);
  border:1px solid var(--border); border-radius:12px;
  padding:.5rem .8rem;         /* antes .55 .9 */
  cursor:pointer;
}
.btn-secondary:hover{ box-shadow:0 0 0 3px rgba(80,118,226,.15); }

/* =========================================================
   GRID
   ========================================================= */
/* ─ Más espacio para la columna derecha (calificaciones/comentarios)
     y un poco menos para la izquierda */
.survey-grid{
  display:grid; gap:8px;       /* antes 10px -> más compacto */
  grid-template-columns: .9fr 1.1fr;  /* antes 1fr 1.5fr  -> derecha más ancha que izq pero sin exagerar */
  grid-template-areas:
    "reporte        calificaciones"
    "proceso        calificaciones"
    "subproceso     calificaciones"
    "cargo          calificaciones"
    "frecuencia     comentarios"
    "submit         comentarios";
  grid-auto-rows:minmax(0,auto);
  position:relative;
  padding-bottom:64px;         /* antes 76px -> menos alto del sticky */
  width:100%;
}

.reporte{         grid-area: reporte; }
.proceso{         grid-area: proceso; }
.subproceso{      grid-area: subproceso; }
.cargo{           grid-area: cargo; }
.calificaciones{  grid-area: calificaciones; }
.frecuencia{      grid-area: frecuencia; }
.comentarios{     grid-area: comentarios; }
.sticky{          grid-area: submit; }

/* ─ Tarjetas más compactas verticalmente */
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:6px;                 /* antes 4px, lo subimos un poco pero compactamos dentro de campos */
  box-shadow:var(--shadow);
}

/* ─ Footer sticky más fino */
.sticky{
  position:sticky; bottom:0; left:0; right:0;
  display:flex; justify-content:flex-end; gap:8px; /* antes 10px */
  padding:6px;                                     /* antes 8px  */
  backdrop-filter: blur(6px);
  background:linear-gradient(0deg, rgba(255,255,255,.95), rgba(255,255,255,.6));
  border-radius:10px; border:1px solid var(--border); margin-top:6px;
}
:root[data-theme="dark"] .sticky{
  background:linear-gradient(0deg, rgba(54, 60, 82, 0.95), rgba(58, 73, 133, 0.6));
}

@media (max-width: 900px){
  .survey-grid{
    grid-template-columns: 1fr;
    grid-template-areas:
      "reporte"
      "proceso"
      "subproceso"
      "cargo"
      "calificaciones"
      "frecuencia"
      "comentarios"
      "submit";
  }
}

/* =========================================================
   CAMPOS
   ========================================================= */
/* ─ Un poco menos de separación en labels y hints */
.label{ display:block; font-weight:700; margin-bottom:6px; color:var(--ink); } /* antes 8px */
.hint{ font-size:.9rem; color:var(--ink-muted); margin-top:4px; }              /* antes 6px */
.hint.error{ color:#D95757; }

/* ─ Inputs/Selects/Textarea más compactos */
.input, .select, .textarea{
  width:100%; border-radius:12px; outline:none; font-family:inherit;
  border:1px solid var(--border);
  padding:.6rem .8rem;         /* antes .75 .9 */
  background:#f7f9ff; color:var(--ink);
}
:root[data-theme="dark"] .input,
:root[data-theme="dark"] .select,
:root[data-theme="dark"] .textarea{
  background:#373d53; color:#EAF0FF;
}
.input:focus, .select:focus, .textarea:focus{
  border-color: var(--blue-400);
  box-shadow:0 0 0 3px rgba(131,164,255,.15);
}
.readonly{ opacity:.9; }

.select:disabled{
  opacity:.9; cursor:not-allowed; background:#f0f3ff;
}
:root[data-theme="dark"] .select:disabled{
  background:#2e3448; color:#cfd7ff;
}

/* =========================================================
   MATRIZ 1–5
   ========================================================= */
/* ─ Encabezado de bloque con menos altura */
.block-head{ display:flex; align-items:baseline; gap:10px; margin-bottom:8px; }  /* antes 12/10 */
.block-title{ margin:0; font-size:14px; color:var(--ink); }

/* ─ Tabla de calificaciones con celdas más bajas */
.matrix{
  margin-top:6px;                /* antes 10px */
  border:1px solid var(--border);
  border-radius:12px; overflow:hidden;
}
.matrix-head, .matrix-row{
  display:grid; grid-template-columns:1.5fr repeat(5, 1fr); /* etiqueta un pelín más angosta */
}
.matrix-head{
  background:#e9efff; color:#45527a; font-weight:700;
}
:root[data-theme="dark"] .matrix-head{
  background:#373d53; color:#cfe0ff;
}
.matrix-row:nth-child(even){ background:#f3f6ff; }
:root[data-theme="dark"] .matrix-row:nth-child(even){ background:#45527a; }

.cell{ padding:8px 10px; border-bottom:1px solid var(--border); } /* antes 10px 12px */
.center{ display:flex; align-items:center; justify-content:center; }
.row-label{ font-weight:700; color:var(--ink); }

/* ─ Radios iguales pero sin exceso de altura */
.matrix input{ display:none; }
.dot{
  width:18px; height:18px; border-radius:50%;
  border:2px solid var(--blue-400); display:inline-flex; cursor:pointer;
  transition: all .15s ease;
}
.matrix input:checked + .dot{
  background:var(--green-600);
  border-color:var(--blue-600);
  box-shadow:0 0 0 4px rgba(104, 226, 80, 0.18);
}
.dot:hover{ transform:scale(1.40); }

/* =========================================================
   SEGMENTED
   ========================================================= */
/* ─ Pastillas un poco más pequeñas */
.segmented{
  display:grid; grid-template-columns:repeat(4,1fr); gap:6px;  /* antes 8px */
  background:#eef2ff; padding:6px;                            /* antes 8px */
  border-radius:12px; border:1px solid var(--border);
}
:root[data-theme="dark"] .segmented{ background:#373d53; }
.segmented input{ display:none; }
.segmented label{
  display:block; text-align:center; padding:.5rem .35rem;      /* antes .6 .4 */
  border-radius:10px; cursor:pointer; border:2px solid transparent;
  user-select:none; font-weight:600; color:var(--ink);
}
.segmented input:checked + label{
  background:linear-gradient(135deg, var(--blue-700), var(--primary));
  color:var(--primary-ink); border-color:transparent;
  box-shadow: inset 0 0 0 3px rgba(255,255,255,.08);
}
.segmented label:hover{ border-color:#45527a; }

/* =========================================================
   BOTONES
   ========================================================= */
.btn-primary{
  background:linear-gradient(135deg, var(--blue-700), var(--primary));
  color:#fff; border:0; padding:.8rem 1rem;     /* antes .9 1.2 */
  border-radius:12px;
  font-weight:700; cursor:pointer; box-shadow:var(--shadow); font-family: inherit;
}
.btn-primary:hover{ filter:brightness(1.05); transform:translateY(-1px); }

/* =========================================================
   MODAL
   ========================================================= */
.modal-backdrop{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.45);
  display: none;
  place-items: center;
  z-index: 999;
}
.modal-backdrop.is-open{ display:grid; }

.modal-card{
  width: min(560px, 92vw);
  background: var(--card);
  color: var(--ink);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 20px 18px 16px;
  position: relative;
  text-align: center;
}

.modal-close{
  position: absolute;
  top: 8px; right: 10px;
  width: 32px; height: 32px;
  border-radius: 50%;
  border: 1px solid var(--border);
  background: transparent;
  color: var(--ink);
  cursor: pointer;
  font-size: 18px;
  line-height: 28px;
}
.modal-close:hover{ box-shadow: 0 0 0 3px rgba(131,164,255,.15); }

.hero-avatar{
  width: 108px; height: 108px;
  border-radius: 50%;
  margin: 4px auto 8px;
  background: radial-gradient(circle at 30% 30%, var(--blue-600), var(--blue-700));
  display:grid; place-items:center;
  filter: drop-shadow(0 12px 24px rgba(0,0,0,.18));
}
.hero-avatar img{
  max-width:64px; height:auto; user-select:none; pointer-events:none;
}

.modal-title{
  margin: 6px 0 8px;
  font-size: 1.4rem;
  color: var(--ink);
  font-weight: 800;
}
.modal-text{
  margin: 0 6px 14px;
  color: var(--ink-muted);
  font-size: 1rem;
}
.modal-actions{
  display: flex;
  justify-content: center;
  gap: 10px;
}

/* ===== Asterisco rojo automático para campos obligatorios ===== */
.label.required::after,
.block-title.required::after{
  content: " *";
  color: #d9534f;               /* rojo */
  font-weight: 800;
}

/* ===== Contador de palabras debajo del textarea ===== */
.word-counter{
  margin-top: 6px;
  font-size: 0.95rem;
  color: var(--ink-muted);
}

/* ─ Si superas el límite, muéstralo en rojo (para #wordCounter del HTML) */
#wordCounter.over,
.word-counter.over{
  color: #d9534f;
  font-weight: 700;
}

/* botón desactivado si superas el límite (se lo pondremos por JS) */
.btn-primary[disabled]{
  opacity: .6;
  cursor: not-allowed;
}

/* =========================================================
   CONFETTI
   ========================================================= */
.confetti{
  position:absolute;
  inset:0;
  pointer-events:none;
  overflow:hidden;
  opacity:0;
  transition:opacity .2s ease;
}
.modal-backdrop.celebrate .confetti{ opacity:1; }

.confetti span{
  position:absolute;
  top:-12vh;
  left:0;
  width:var(--size, 10px);
  height:calc(var(--size, 10px) * 1.6);
  border-radius:2px;
  background: var(--conf-color, #5076E2);
  transform: translate3d(0,-10vh,0) rotate(0deg);
  will-change: transform, opacity;
  animation: none;
  box-shadow: 0 2px 6px rgba(0,0,0,.12);
}
.modal-backdrop.celebrate .confetti span{
  animation: confettiFall var(--dur, 3s) linear var(--delay, 0s) forwards;
}
@keyframes confettiFall{
  0%   { transform: translate3d(0, -10vh, 0) rotate(0deg);     opacity: .98; }
  50%  { transform: translate3d(var(--tx50, 0px), 55vh, 0) rotate(180deg); opacity: 1; }
  100% { transform: translate3d(var(--tx100, 0px), 110vh, 0) rotate(360deg); opacity: .98; }
}
