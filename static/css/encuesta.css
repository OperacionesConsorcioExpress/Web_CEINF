/* =========================================================
   TOKENS Y TEMAS
   ========================================================= */
:root{
  --blue-900:#25397A;
  --blue-800:#324A8E;
  --blue-700:#3F5DB2;
  --blue-600:#5076E2;
  --blue-400:#83A4FF;
  --blue-200:#BBCCF9;

  --green-700:#16A038;
  --green-600:#2BC14B;
  --green-500:#3EE561;

  --white:#FFFFFF;
  --black:#000000;

  --radius:16px;
  --shadow:0 10px 30px rgba(0,0,0,.12);
}

/* Tema claro */
:root,
:root[data-theme="light"]{
  --bg:#FFFFFF;
  --card:#F3F6FF;
  --ink:#0E1A3A;
  --ink-muted:#4F5E87;
  --primary:var(--blue-600);
  --primary-ink:var(--white);
  --border:rgba(37,57,122,.18);
  --shadow:0 10px 30px rgba(248, 246, 246, 0.838);
  --title-color:var(--blue-900);
}

/* Tema oscuro */
:root[data-theme="dark"]{
  --bg:linear-gradient(180deg, #34394898, #4c587d);
  --card:#636771;
  --ink:#EAF0FF;
  --ink-muted:#BBCCF9;
  --primary:var(--green-600);
  --primary-ink:var(--white);
  --border:rgba(187,204,249,.25);
  --shadow:0 10px 30px rgba(248, 246, 246, 0.377);
  --title-color:var(--blue-200);
}

/* =========================================================
   BASE
   ========================================================= */
*{ box-sizing:border-box; }
html,body{ height:100%; }
html{ font-size:12px; }

body.body{
  margin:10px; padding:10px;
  background:var(--bg); color:var(--ink);
  font:12px/1.45 "Century Gothic",system-ui,-apple-system,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
  overflow-x:hidden;
}

.survey-shell{
  min-height:100vh;
  display:flex; flex-direction:column;
  padding:0 26px;
  width:100vw; max-width:100vw;
}

/* =========================================================
   HEADER
   ========================================================= */
.survey-header{
  display:inline-flex; align-items:flex-start; justify-content:space-between;
  gap:16px; margin-bottom:12px;
}
.title{ margin:0; font-size:2rem; color:var(--title-color); }
.subtitle{ margin:0; color:var(--ink-muted); }
.brand-right{ display:flex; align-items:center; gap:12px; }

.brand-bar{
  display:flex; align-items:center; gap:12px;
  padding:8px 10px; background:#FFFFFF;
  border:1px solid var(--border); border-radius:12px; box-shadow:var(--shadow);
}
:root[data-theme="dark"] .brand-bar{ background:#FFFFFF; }
.brand-logo{ height:36px; width:auto; display:block; }
.brand-logo.ce{ height:34px; }
.brand-logo.ci{ height:42px; }
.brand-logo.pbi{ height:38px; }
.divider{ width:1px; height:28px; background:var(--border); border-radius:2px; }

.btn-secondary{
  background:transparent; color:var(--ink);
  border:1px solid var(--border); border-radius:12px;
  padding:.55rem .9rem; cursor:pointer;
}
.btn-secondary:hover{ box-shadow:0 0 0 3px rgba(80,118,226,.15); }

/* =========================================================
   GRID
   ========================================================= */
.survey-grid{
  display:grid; gap:10px;
  grid-template-columns: 1fr 1.5fr;
  grid-template-areas:
    "reporte        calificaciones"
    "proceso        calificaciones"
    "subproceso     calificaciones"
    "cargo          calificaciones"
    "frecuencia     comentarios"
    "submit         comentarios";
  grid-auto-rows:minmax(0,auto);
  position:relative;
  padding-bottom:76px;
  width:100%;
}

.reporte{         grid-area: reporte; }
.proceso{         grid-area: proceso; }
.subproceso{      grid-area: subproceso; }
.cargo{           grid-area: cargo; }
.calificaciones{  grid-area: calificaciones; }
.frecuencia{      grid-area: frecuencia; }
.comentarios{     grid-area: comentarios; }
.sticky{          grid-area: submit; }

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:4px;
  box-shadow:var(--shadow);
}

.sticky{
  position:sticky; bottom:0; left:0; right:0;
  display:flex; justify-content:flex-end; gap:10px;
  padding:8px; backdrop-filter: blur(6px);
  background:linear-gradient(0deg, rgba(255,255,255,.95), rgba(255,255,255,.6));
  border-radius:10px; border:1px solid var(--border); margin-top:6px;
}
:root[data-theme="dark"] .sticky{
  background:linear-gradient(0deg, rgba(54, 60, 82, 0.95), rgba(58, 73, 133, 0.6));
}

@media (max-width: 900px){
  .survey-grid{
    grid-template-columns: 1fr;
    grid-template-areas:
      "reporte"
      "proceso"
      "subproceso"
      "cargo"
      "calificaciones"
      "frecuencia"
      "comentarios"
      "submit";
  }
}

/* =========================================================
   CAMPOS
   ========================================================= */
.label{ display:block; font-weight:700; margin-bottom:8px; color:var(--ink); }
.hint{ font-size:.9rem; color:var(--ink-muted); margin-top:6px; }
.hint.error{ color:#D95757; }

.input, .select, .textarea{
  width:100%; border-radius:12px; outline:none; font-family:inherit;
  border:1px solid var(--border);
  padding:.75rem .9rem;
  background:#f7f9ff; color:var(--ink);
}
:root[data-theme="dark"] .input,
:root[data-theme="dark"] .select,
:root[data-theme="dark"] .textarea{
  background:#373d53; color:#EAF0FF;
}
.input:focus, .select:focus, .textarea:focus{
  border-color: var(--blue-400);
  box-shadow:0 0 0 3px rgba(131,164,255,.15);
}
.readonly{ opacity:.9; }

.select:disabled{
  opacity:.9; cursor:not-allowed; background:#f0f3ff;
}
:root[data-theme="dark"] .select:disabled{
  background:#2e3448; color:#cfd7ff;
}

/* =========================================================
   MATRIZ 1–5
   ========================================================= */
.block-head{ display:flex; align-items:baseline; gap:12px; margin-bottom:10px; }
.block-title{ margin:0; font-size:14px; color:var(--ink); }

.matrix{
  margin-top:10px; border:1px solid var(--border);
  border-radius:12px; overflow:hidden;
}
.matrix-head, .matrix-row{
  display:grid; grid-template-columns:1.6fr repeat(5, 1fr);
}
.matrix-head{
  background:#e9efff; color:#45527a; font-weight:700;
}
:root[data-theme="dark"] .matrix-head{
  background:#373d53; color:#cfe0ff;
}
.matrix-row:nth-child(even){ background:#f3f6ff; }
:root[data-theme="dark"] .matrix-row:nth-child(even){ background:#45527a; }

.cell{ padding:10px 12px; border-bottom:1px solid var(--border); }
.center{ display:flex; align-items:center; justify-content:center; }
.row-label{ font-weight:700; color:var(--ink); }

.matrix input{ display:none; }
.dot{
  width:18px; height:18px; border-radius:50%;
  border:2px solid var(--blue-400); display:inline-flex; cursor:pointer;
  transition: all .15s ease;
}
.matrix input:checked + .dot{
  background:var(--green-600);
  border-color:var(--blue-600);
  box-shadow:0 0 0 4px rgba(104, 226, 80, 0.18);
}
.dot:hover{ transform:scale(1.40); }

/* =========================================================
   SEGMENTED
   ========================================================= */
.segmented{
  display:grid; grid-template-columns:repeat(4,1fr); gap:8px;
  background:#eef2ff; padding:8px; border-radius:12px; border:1px solid var(--border);
}
:root[data-theme="dark"] .segmented{ background:#373d53; }
.segmented input{ display:none; }
.segmented label{
  display:block; text-align:center; padding:.6rem .4rem;
  border-radius:10px; cursor:pointer; border:2px solid transparent;
  user-select:none; font-weight:600; color:var(--ink);
}
.segmented input:checked + label{
  background:linear-gradient(135deg, var(--blue-700), var(--primary));
  color:var(--primary-ink); border-color:transparent;
  box-shadow: inset 0 0 0 3px rgba(255,255,255,.08);
}
.segmented label:hover{ border-color:#45527a; }

/* =========================================================
   BOTONES
   ========================================================= */
.btn-primary{
  background:linear-gradient(135deg, var(--blue-700), var(--primary));
  color:#fff; border:0; padding:.9rem 1.2rem; border-radius:12px;
  font-weight:700; cursor:pointer; box-shadow:var(--shadow); font-family: inherit;
}
.btn-primary:hover{ filter:brightness(1.05); transform:translateY(-1px); }

/* =========================================================
   MODAL
   ========================================================= */
.modal-backdrop{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.45);
  display: none;        /* oculto por defecto */
  place-items: center;  /* al abrir, usamos grid */
  z-index: 999;
}
.modal-backdrop.is-open{ display:grid; }

.modal-card{
  width: min(560px, 92vw);
  background: var(--card);
  color: var(--ink);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 20px 18px 16px;
  position: relative;
  text-align: center;
}

.modal-close{
  position: absolute;
  top: 8px; right: 10px;
  width: 32px; height: 32px;
  border-radius: 50%;
  border: 1px solid var(--border);
  background: transparent;
  color: var(--ink);
  cursor: pointer;
  font-size: 18px;
  line-height: 28px;
}
.modal-close:hover{ box-shadow: 0 0 0 3px rgba(131,164,255,.15); }

.hero-avatar{
  width: 108px; height: 108px;
  border-radius: 50%;
  margin: 4px auto 8px;
  background: radial-gradient(circle at 30% 30%, var(--blue-600), var(--blue-700));
  display:grid; place-items:center;
  filter: drop-shadow(0 12px 24px rgba(0,0,0,.18));
}
.hero-avatar img{
  max-width:64px; height:auto; user-select:none; pointer-events:none;
}

.modal-title{
  margin: 6px 0 8px;
  font-size: 1.4rem;
  color: var(--ink);
  font-weight: 800;
}
.modal-text{
  margin: 0 6px 14px;
  color: var(--ink-muted);
  font-size: 1rem;
}
.modal-actions{
  display: flex;
  justify-content: center;
  gap: 10px;
}

/* =========================================================
   CONFETTI (solo una animación para caída + rotación)
   - Se activa cuando el backdrop tiene .celebrate
   ========================================================= */
/* =========================================================
   CONFETTI aleatorio (via variables CSS)
   - Cada partícula define:
     --tx50 , --tx100 : deriva horizontal (px) a mitad y al final
     --dur            : duración animación
     --delay          : retardo
     --size           : tamaño base (ancho/alto)
   ========================================================= */
.confetti{
  position:absolute;
  inset:0;
  pointer-events:none;
  overflow:hidden;
  opacity:0;
  transition:opacity .2s ease;
}
.modal-backdrop.celebrate .confetti{ opacity:1; }

.confetti span{
  position:absolute;
  top:-12vh;
  left:0;                   /* la posición real se fija inline (JS) */
  width:var(--size, 10px);
  height:calc(var(--size, 10px) * 1.6);
  border-radius:2px;
  background: var(--conf-color, #5076E2);
  transform: translate3d(0,-10vh,0) rotate(0deg);
  will-change: transform, opacity;
  /* Por defecto sin animación; se activa al celebrar */
  animation: none;
  /* Sombra sutil para volumen */
  box-shadow: 0 2px 6px rgba(0,0,0,.12);
}

/* Al celebrar, arrancamos la animación con las variables personalizadas */
.modal-backdrop.celebrate .confetti span{
  animation: confettiFall var(--dur, 3s) linear var(--delay, 0s) forwards;
}

/* Caída con dos puntos de control y rotación completa */
@keyframes confettiFall{
  0%   { transform: translate3d(0, -10vh, 0) rotate(0deg);     opacity: .98; }
  50%  { transform: translate3d(var(--tx50, 0px), 55vh, 0) rotate(180deg); opacity: 1; }
  100% { transform: translate3d(var(--tx100, 0px), 110vh, 0) rotate(360deg); opacity: .98; }
}
